class DoubleBuffer{constructor(can1,can2){this.canvas1=can1;this.canvas2=can2}}var buffers=Array();function plotAt(number){buffers[number]=new DoubleBuffer}function crearCanvas(id,height,width){var can=document.createElement("canvas");can.id=id;can.height=height;can.width=width;can.style.overflow="hidden";return can}var canvas1;var canvas2;var already=true;function init(){var MAXX=parseInt(window.getComputedStyle(document.body).width);var MAXY=parseInt(window.getComputedStyle(document.body).height);if(MAXY==0){MAXY=MAXX}var div=document.getElementById("container_div");if(!div){div=document.createElement("div");div.id="container_div";already=false}div.style.cssText=div.style.cssText+"background: transparent/*rgba(40,40,40,.6)*/; width:100%; height:100%; margin:auto;";canvas1=document.getElementById("canvas1");canvas2=document.getElementById("canvas2");if(!canvas1){canvas1=crearCanvas("canvas1",MAXX,MAXY);canvas1.style.visibility="visible";canvas2=crearCanvas("canvas2",MAXX,MAXY);canvas2.style.visibility="hidden";div.appendChild(canvas1);div.appendChild(canvas2);if(!already){document.body.appendChild(div)}}window.addEventListener("resize",resize);resize()}init();var resizeCallback;function resize(){var width=window.innerWidth||document.documentElement.clientWidth;var height=window.innerHeight||document.documentElement.clientHeight;var canvas=getCanvasVisible();canvas.style.width="100%";canvas.style.height="100%";canvas.width=canvas.offsetWidth;canvas.height=canvas.offsetHeight;canvas=getCanvasInvisible();canvas.style.width="100%";canvas.style.height="100%";canvas.width=canvas.offsetWidth;canvas.height=canvas.offsetHeight;replot();if(typeof resizeCallback==="function"){resizeCallback()}}function flushBuffer(clear=true){var ctxVisible=getCanvasVisible().getContext("2d");if(clear){var canvasVisible=getCanvasVisible();ctxVisible.clearRect(0,0,canvasVisible.width,canvasVisible.height)}ctxVisible.drawImage(getCanvasInvisible(),0,0)}function getCanvasInvisible(){return canvas2}function getCanvasVisible(){return canvas1}function fit(in0,from0,to0,fromFix0,toFix0){if(from0==to0)return from0;var a1=from0;var a2=to0;var b1=1;var b2=1;var c1=fromFix0;var c2=toFix0;var den=a2*b1-a1*b2;var res=0;if(den!=0){var m=(b1*c2-b2*c1)/den;var h=(a2*c1-a1*c2)/den;res=in0*m+h}else{console.log("error div 0")}return res}function min(arr){var args=[...arguments].join().split(",");return Math.min.apply(Math,args)}function max(){var args=[...arguments].join().split(",");return Math.max.apply(Math,args)}function rgbStrToArr(str){ret=str.replace(/[^\d,.]/g,"").split(",");if(ret.length==3){ret.push("1")}return ret.map(Number)}function rgbarrToStr(colorArr,round=false){if(round){f=Math.round}else{f=x=>x}if(colorArr.length==3){return"rgb("+f(colorArr[0])+", "+f(colorArr[1])+", "+f(colorArr[2])+")"}else if(colorArr.length==4){return"rgba("+f(colorArr[0])+", "+f(colorArr[1])+", "+f(colorArr[2])+", "+colorArr[3]+")"}else{console.log("wtf");return}}function alpha(color,alpha){if(alpha>=1||color.length<12)return color;arr=rgbStrToArr(color);arr[3]=alpha;return rgbarrToStr(arr)}var lastPlotArgs=null;var lastPlotRefArgs=null;function replot(){if(lastPlotArgs!=null){plot(...lastPlotArgs)}if(lastPlotRefArgs!=null){plotRef(...lastPlotRefArgs)}}var coloresDefault=["rgba(144, 238, 144, .8)","rgba(255, 255, 0, .7)","rgba(170, 200, 250, .8)","rgba(155, 100, 200, .8)","rgba(255, 100, 0, .8)"];var escalaXFun=null;function plotScaleX(fun){escalaXFun=fun}function plotColors(...arg){var arg=arg.map(((color,i)=>{if(typeof color=="undefined"||color==null||color=="null"){return coloresDefault[i]}else{return color}}));coloresDefault=arg}function getColors(i){var arr=coloresDefault;return arr[i%arr.length]}const radioDefault=5;var lastValues=Array();function plotRef(){lastPlotRefArgs=JSON.parse(JSON.stringify([...arguments]));var canvas=getCanvasInvisible();var ctx=canvas.getContext("2d");ctx.font="16px Arial";[...arguments].forEach(((arg,i)=>{ctx.beginPath();var color=getColors(i);ctx.fillStyle=color;var ubicacionx=canvas.width/7;var ubicaciony=canvas.height/6;ctx.fillText(arg+" ["+Math.round(lastValues[i]*1e3)/1e3+"]",ubicacionx+11,ubicaciony+i*16+4);var radio=5;ctx.strokeStyle=color;ctx.fillRect(ubicacionx,ubicaciony+i*16,radio,radio);ctx.fill();ctx.stroke()}));flushBuffer(false)}function equalArrays(arr1,arr2){if(Array.isArray(arr1)&&Array.isArray(arr2)){return arr1.length===arr2.length&&arr1.every(((value,index)=>equalArrays(value,arr2[index])))}else{return arr1===arr2}}function plotOnResize(resizeCall){resizeCallback=resizeCall}function plot(){if(this!=null&&this.tagName=="canvas"){canvas=this}else{}lastPlotArgs=JSON.parse(JSON.stringify([...arguments]));var canvas=getCanvasInvisible();var ctx=canvas.getContext("2d");ctx.clearRect(0,0,canvas.width,canvas.height);var radio=radioDefault;var SCOPE_MAX=canvas.height-radio;var SCOPE_MIN=radio;var[minTotal,maxTotal]=[min([...arguments]),max([...arguments])];var zeroRef=minTotal<0?max(minTotal,0):min(minTotal,0);var yZeroInCanvas=Math.round(fit(zeroRef,minTotal,maxTotal,SCOPE_MIN,SCOPE_MAX));var escalaSobreEje=false;if(yZeroInCanvas<0){yZeroInCanvas=0;escalaSobreEje=false}else if(yZeroInCanvas>SCOPE_MAX){yZeroInCanvas=SCOPE_MAX;escalaSobreEje=true}yZeroInCanvas=SCOPE_MAX-yZeroInCanvas+radio;var escalaTOP=(Math.round(maxTotal*100)/100).toFixed(2);var escalaDOWN=(Math.round(minTotal*100)/100).toFixed(2);var primerArray=arguments[0];var arrayReferenciaLen=primerArray.length!=0?primerArray.length:10;var T=canvas.width/arrayReferenciaLen;if(T<1){T=1}var x=0;var y=0;var radioEjeX=1;var radioEjeY=2;ctx.beginPath();const DIVISIONES_X=20;const DIVISIONES_Y=20;ctx.strokeStyle="lightgray";ctx.fillStyle="lightgray";for(var n=0;n<arrayReferenciaLen;n++){ctx.font="16px Arial";if(n==0||n%(1+Math.round(arrayReferenciaLen/DIVISIONES_X))==0){if(escalaXFun!=null){ctx.fillText(escalaXFun(n),Math.round(x)-3,-20+yZeroInCanvas+(escalaSobreEje?16:-5))}ctx.fillText(Math.round(n*100)/100,Math.round(x)-3,yZeroInCanvas+(escalaSobreEje?16:-5));ctx.fillStyle="rgba(200,200,200,.05)";ctx.fillRect(Math.round(x),0,radioEjeX,SCOPE_MAX)}else{ctx.fillStyle="rgba(200,200,200,.02)";ctx.fillRect(Math.round(x),0,radioEjeX,SCOPE_MAX)}ctx.fillStyle="lightgray";ctx.fillRect(Math.round(x),yZeroInCanvas,radioEjeX,radio);ctx.fill();x+=T}ctx.stroke();ctx.beginPath();var T=(SCOPE_MAX-SCOPE_MIN)/DIVISIONES_Y;if(T<1){T=1}var y=0;ctx.fillStyCanvasle="gray";ctx.strokeStyCanvasle="gray";ctx.font="16px Arial";for(var yCanvas=SCOPE_MIN;yCanvas<SCOPE_MAX;yCanvas+=T){yCanvasRound=Math.round(yCanvas);var val=fit(yCanvas,SCOPE_MIN,SCOPE_MAX,maxTotal,minTotal);ctx.font="16px Arial";{if(yCanvasRound!=0&&yCanvasRound!=SCOPE_MAX&&yCanvasRound!=SCOPE_MIN){ctx.fillText("["+Math.round(val*100)/100+"]",5,yCanvas+5)}ctx.fillStyle="rgba(200,200,200,.05)";ctx.fillRect(0,yCanvasRound,SCOPE_MAX*T,radioEjeX);ctx.fillStyle="lightgray"}ctx.fillRect(0,yCanvasRound,radioEjeY,radioEjeX);ctx.fill()}ctx.stroke();var i=0;var argumentsCopy=JSON.parse(JSON.stringify([...arguments]));var maximaCantidadDatos=Math.max(...argumentsCopy.map((i=>i.length)));var x=Array(maximaCantidadDatos);x.fill(0);for(var i=0;i<argumentsCopy.length;i++){var valorDatos=0;for(var jIndexPoint=0;jIndexPoint<maximaCantidadDatos;jIndexPoint++){var arrProcesado=argumentsCopy[i];var T=canvas.width/arrProcesado.length;if(T<1){T=1}if(jIndexPoint>=arrProcesado.length)break;valorDatos=arrProcesado[jIndexPoint];var ycanvas=fit(valorDatos,minTotal,maxTotal,SCOPE_MAX,SCOPE_MIN);var color=getColors(i);ctx.strokeStyle=color;ctx.fillStyle=alpha(color,.6);radio=radioDefault;var ZOH=true;var xcanvas=Math.round(x[i]);ctx.beginPath();{ctx.fillRect(xcanvas,ycanvas,ZOH?T:radio,radio)}x[i]+=T;ctx.fill();ctx.stroke()}lastValues[i]=valorDatos}flushBuffer()}